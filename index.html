<!DOCTYPE html>
<html>
    <head>
        <!-- Basic Page Needs
        –––––––––––––––––––––––––––––––––––––––––––––––––– -->
        <meta charset="utf-8">
        <meta name="description" content="">
        <meta name="author" content="">

        <!-- Mobile Specific Metas
        –––––––––––––––––––––––––––––––––––––––––––––––––– -->
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- FONT
        –––––––––––––––––––––––––––––––––––––––––––––––––– -->
        <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

        <!-- CSS
        –––––––––––––––––––––––––––––––––––––––––––––––––– -->
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/skeleton.css">
        <link rel="stylesheet" href="css/ee374.css">

        <title>EE 374: Blockchain Foundations at Stanford</title>
    </head>
    <body><div class="container"><div class="row"><div class="column" style="margin-top: 20pt">
        Stanford EE374, Spring 2022
        <h1>Blockchain Foundations</h1>

        <p>
            Blockchains are a new field of computer science which combines
            cryptography, distributed systems, and security. In this course,
            we go deep in understanding the fundamentals:
            What are blockchains, how do they work, and why are they secure?
        </p>

        <h2>Basic Info</h2>
        <ul>
            <li>Wed/Fri 3:15-4:45pm</li>
            <li><strong>Location</strong>: 200-034</li>
            <li><strong>Instructors</strong>: Prof. <a href='https://tselab.stanford.edu/people/principal-investigator/david-tse'>David Tse</a>, Dr. <a href='https://dionyziz.com'>Dionysis Zindros</a></li>
            <li><strong>Teaching Assistants</strong>: <a href='https://sites.google.com/stanford.edu/kamilla-nazirkhanova'>Kamilla Nazirkhanova</a>, <a href='https://ssrivatsan97.github.io/ '>Srivatsan Sridhar</a></li>
            <li><strong>Grader</strong>: <a href='https://profiles.stanford.edu/cynthia-liu'>Cynthia Liu</a></li>
            <li>
                <a href='https://canvas.stanford.edu/courses/155937'>Canvas</a>
                •
                <a href="https://piazza.com/class/l0fnr8i6xbr20a">Piazza</a>
            </li>
        </ul>

        <h2>Office hours</h2>
        <ul>
            <li>David Tse: By appointment</li>
            <li>Dionysis Zindros: Wed 5-6pm &amp; Thu 11am-noon, Packard 106</li>
            <li>Kamilla Nazirkhanova: Tue 10-11am, Packard 106</li>
            <li>Srivatsan Sridhar: Thu 1-2pm, Packard 106</li>
        </ul>

        <h2>Lecture Notes</h2>
        <ol>
            <li><a href="lec_notes/lec1-2.pdf">Lectures 1-2</a></li>
            <li><a href="lec_notes/lec3.pdf">Lecture 3</a></li>
            <li><a href="lec_notes/lec4.pdf">Lecture 4</a></li>
            <li><a href="lec_notes/lec5.pdf">Lecture 5</a></li>
            <li><a href="lec_notes/lec6.pdf">Lecture 6</a></li>
            <li><a href="lec_notes/lec7.pdf">Lecture 7</a></li>
            <li><a href="lec_notes/lec8.pdf">Lecture 8</a></li>
            <li><a href="lec_notes/lec9.pdf">Lecture 9</a></li>
            <li><a href="lec_notes/lec10.pdf">Lecture 10</a></li>
            <li><a href="lec_notes/lec11.pdf">Lecture 11</a></li>
            <li><a href="lec_notes/lec12.pdf">Lecture 12</a></li>
            <li><a href="lec_notes/lec13.pdf">Lecture 13</a></li>
            <li><a href="lec_notes/lec14.pdf">Lecture 14</a></li>
            <li><a href="lec_notes/lec15.pdf">Lecture 15</a></li>
        </ol>

        <h2>Problem Sets</h2>

        <p>Develop your own full node of the <a href="/protocol">Marabu Protocol</a>.</p>

        <ol>
            <li><a href="psets/pset1.pdf">Problem set 1</a></li>
            <li><a href="psets/pset2.pdf">Problem set 2</a></li>
            <li><a href="psets/pset3.pdf">Problem set 3</a></li>
            <li><a href="psets/pset4.pdf">Problem set 4</a></li>
            <li><a href="psets/pset5.pdf">Problem set 5</a></li>
            <li><a href="psets/pset6.pdf">Problem set 6</a></li>
        </ol>

        <h2>Solutions</h2>
        <ol>
            <li><a href="solutions/malibu-pset1-a624a17.tar">Problem set 1</a></li>
            <li><a href="solutions/malibu-pset2-a100323.tar">Problem set 2</a></li>
            <li><a href="solutions/malibu-pset3-60cc81d.tar">Problem set 3</a></li>
            <li><a href="solutions/malibu-pset4-b44720a.tar">Problem set 4</a></li>
        </ol>

        <h2>Exams</h2>
        <ol>
            <li><a href="exams/EE_374_Spring_2022_Midterm_Solutions.pdf">Midterm with solutions</a></li>
        </ol>

        <h2>Overview</h2>
        <p>
            This graduate-level course teaches you about blockchain foundations. The course focuses on the first principles and foundations behind blockchains with the aim of understanding how and why blockchain technology works and is secure. We do not focus on Bitcoin or Ethereum engineering peculiarities, but we explore the general concepts of the blockchain field. However, the course is heavy on both engineering (writing code) and theory.
        </p>

        <p>
            The course focuses on three questions:

            <ul>
                <li>What are blockchains?</li>
                <li>How do they work?</li>
                <li>Why are they secure?</li>
            </ul>
        </p>

        <h2>Spring 2022 Schedule</h2>

        <p>
            The topics of the course include proof-of-work (in static and variable difficulty), proof-of-stake, transactions in the UTXO and accounts model, authenticated data structures such as Merkle Trees, and simple payment verification. A central topic of the course is understanding why blockchains are secure. We treat the question in theoretical depth using the cryptographic backbone model.
        </p>

        <p>
            The full syllabus is as follows (we may still make small revisions).
        </p>

        <h3>Lecture 1: Money</h3>
        <ul>
            <li>Administrivia</li>
            <li>Money as a social construct</li>
            <li>The network model</li>
            <li>The non-eclipsing assumption</li>
            <li>The gossip protocol</li>
        </ul>

        <h3>Lecture 2: The adversary</h3>
        <ul>
            <li>The adversary A</li>
            <li>The security parameter κ</li>
            <li>The honest protocol Π</li>
            <li>The adversarial model</li>
            <li>Probabilistic polynomial-time adversaries</li>
            <li>Negligible functions</li>
            <li>Game-based security</li>
            <li>Security proofs by computation reduction</li>
            <li>Proofs by contradiction and forward proofs</li>
        </ul>

        <h3>Lecture 3: Primitives</h3>
        <ul>
            <li>The hash function: H</li>
            <li>Preimage resistance, second preimage resistance, collision resistance</li>
            <li>Collision resistance implies preimage resistance</li>
            <li>Preimage resistance implies second preimage resistance</li>
            <li>Public/private keys</li>
            <li>Signature schemes</li>
            <li>Signature correctness</li>
            <li>Existential unforgeability</li>
            <li>Ledgers</li>
        </ul>

        <h3>Lecture 4: Transactions</h3>
        <ul>
            <li>Transactions</li>
            <li>Inputs and outputs</li>
            <li>The transaction graph</li>
            <li>Change</li>
            <li>Multiple inputs</li>
            <li>Multiple outputs</li>
            <li>The UTXO model</li>
            <li>The law of conservation</li>
            <li>Verifying a transaction</li>
        </ul>

        <h3>Lecture 5: Blocks</h3>
        <ul>
            <li>Views in disagreement</li>
            <li>Double spending</li>
            <li>The network delay Δ</li>
            <li>Simple ideas don't work!</li>
            <li>Rare events</li>
            <li>Blocks</li>
            <li>Proof-of-work</li>
            <li>The mining target T</li>
            <li>The proof-of-work equation</li>
            <li>The mining algorithm</li>
            <li>Block freshness</li>
            <li>The genesis block G</li>
            <li>Chains</li>
        </ul>

        <h3>Lecture 6: Chains</h3>
        <ul>
            <li>Hash chains</li>
            <li>The number n of parties</li>
            <li>The number t of adversarial parties</li>
            <li>The hashing power q</li>
            <li>Rare events are irregular</li>
            <li>Convergence opportunities and periods of silence</li>
            <li>The honest majority assumption</li>
            <li>The longest chain rule</li>
            <li>Coinbase</li>
            <li>Fees</li>
            <li>Mempools</li>
        </ul>

        <h3>Lecture 7: Chain Virtues</h3>
        <ul>
            <li>Temporary forks</li>
            <li>Convergence</li>
            <li>The Nakamoto race</li>
            <li>Chain Growth, Common Prefix, Chain Quality</li>
            <li>Censorship</li>
            <li>Majority attacks</li>
        </ul>

        <h3>Lecture 8: Attacks</h3>
        <ul>
            <li>Healing</li>
            <li>Macroeconomic supply</li>
            <li>Selfish mining</li>
            <li>Mining pools</li>
        </ul>

        <h3>Lecture 9: Variable Difficulty, Pools, Wallets</h3>
        <ul>
            <li>CPU, GPU, ASIC mining</li>
            <li>Incentive compatibility</li>
            <li>Block size limits</li>
            <li>Transaction prioritization by fees</li>
            <li>Macroeconomic policy, reward adjustment</li>
            <li>The difficulty adjustment equation Τ_{j+1} = T_{j} (t_2 - t_1) / (mη)</li>
            <li>Mining pools, the light PoW equation: H(B) ≤ 2^z T</li>
            <li>The pooled mining protocol</li>
            <li>Cold, hot, and hardware wallets</li>
            <li>Wallet seeds, deterministic wallets</li>
        </ul>

        <h4>Lecture 10: Accounts and Balances, Merkle Trees</h4>
        <ul>
            <li>The account model</li>
            <li>Transactions in the account model</li>
            <li>Balances</li>
            <li>Nonces</li>
            <li>The generic transition function δ</li>
            <li>Blockchain as a State Machine Replication mechanism</li>
            <li>UTXO vs accounts</li>
            <li>The file storage problem</li>
            <li>The Merkle Tree: compress, prove, verify</li>
            <li>Proofs of inclusion, succinctness</li>
            <li>Merkle Tree security proof by reduction from collision-resistant hashes</li>
        </ul>

        <h4><a href='https://stanford.zoom.us/rec/play/GCIVyL92oqcR-wSwurPLlgrUTHjoN5MA75855dwE30H8zjYcKpJ4HBJ8e-wCeOppl15FHasnROvwLJN8.jNWLpZAJ_F5GnrY5Links to an external site.'>Lecture 11: Light Clients; Backbone warmup</a></h4>
        <ul>
            <li>The problem of scalability in blockchains: Scaling computation, communication, and storage</li>
            <li>From x-bar to x using Merkle Trees</li>
            <li>The Simple Payment Verification (SPV) protocol</li>
            <li>The header chain</li>
            <li>Miners, Full Nodes, Light Nodes</li>
            <li>Chain virtues for light nodes</li>
            <li>Privacy concerns for light nodes</li>
            <li>Random Oracles, formally</li>
            <li>The synchrony assumption Δ = 1. The round.</li>
        </ul>

        <h4>Lecture 12: Security in Earnest (I)</h4>
        <ul>
            <li>The Environment and the Execution</li>
            <li>The Rushing Adversary</li>
            <li>The Sybil Adversary</li>
            <li>The Network model, the gossiping model</li>
            <li>The Non-Eclipsing Assumption</li>
            <li>The honest backbone protocol</li>
            <li>Maintaining, adopting, and having chains</li>
            <li>Proof-of-work</li>
            <li>The q-bounded Random Oracle</li>
            <li>The Static Difficulty assumption</li>
            <li>Chain validation; the δ* function</li>
            <li>Successful rounds</li>
            <li>Convergence opportunities</li>
            <li>Formal definition of Chain Virtues</li>
            <li>Common Prefix, the parameter k</li>
            <li>Chain Quality, the parameters μ and ℓ</li>
            <li>Chain Growth, the parameters τ and s</li>
            <li>The formal honest majority assumption: t &lt; (1 - δ)(n - t)</li>
            <li>The honest advantage δ</li>
            <li>Convergence Opportunities are useful: The Pairing Lemma and its proof</li>
        </ul>

        <h4>Lecture 13: Security in Earnest (II)</h4>
        <ul>
            <li>Ledger Safety and Liveness, formally. The liveness parameter u.</li>
            <li>Proof of Safety from Common Prefix</li>
            <li>Proof of Liveness from Chain Quality and Chain Growth; u = max((ℓ + k) / τ, s)</li>
            <li>The Chain Growth Lemma and its proof</li>
            <li>The successful round indicator X</li>
            <li>The convergence opportunity indicator Y</li>
            <li>The adversarial success indicator Z</li>
            <li>The expectations of X, Y, and Z</li>
            <li>Bernoulli's inequality</li>
            <li>Lower and upper bounds on the expectation of X</li>
            <li>Lower bounds on the expectation of Y</li>
            <li>Good things converge: The Chernoff bound</li>
            <li>The world is good, usually: Typical executions</li>
            <li>The Chernoff duration λ</li>
            <li>The Chernoff error ε</li>
            <li>Proof of Typicality Theorem</li>
            <li>The Balancing Equation: 3ε + 3f &leq; δ</li>
            <li>A plot of X, Y, and Z with 3f, 3ε and δ</li>
        </ul>

        <h4>Lecture 14: Security in Earnest (III)</h4>
        <ul>
            <li>Reminder of bounds on the expectations of X and Y</li>
            <li>Upper bound on the expectation of Z</li>
            <li>Typical bounds, and proof that Z &leq; Y</li>
            <li>Chains grow: The Chain Growth theorem and its proof</li>
            <li>The Patience Lemma and its proof</li>
            <li>The Common Prefix theorem and its proof</li>
            <li>Discussion on the relationship between ε and λ</li>
            <li>You can't have it all: Discussion on the parametrization options for ε, f, δ</li>
        </ul>

        <h3>Lecture 15: Longest Chain Proof of Stake (I)</h3>
        <ul>
            <li>Proof of Work's perils and environmental impact</li>
            <li>Proof of Work vs Proof of Stake</li>
            <li>Dangers of Proof of Stake</li>
            <li>The Proof of Stake equation</li>
        </ul>

        <h3>Lecture 16: Longest Chain Proof of Stake (II)</h3>
        <ul>
            <li>Proof of Work's perils and environmental impact</li>
            <li>Proof of Work vs Proof of Stake</li>
            <li>Dangers of Proof of Stake</li>
            <li>The Proof of Stake equation</li>
        </ul>

        <h3>Lecture 17: BFT Proof of Stake (I)</h3>
        <ul>
            <li>Everything is a Race and Nakamoto Always Wins</li>
            <li>Verifiable Random Functions</li>
            <li>VRF correctness</li>
            <li>The unpredictability game</li>
            <li>Towards instant finality</li>
        </ul>

        <h3>Lecture 18: BFT Proof of Stake (II)</h3>
        <ul>
            <li>The Streamlet protocol and its proof of safety</li>
        </ul>

        <h2>Who is this course for?</h2>

        <p>
            This is a new course for graduate-level students in computer science, electrical engineering, or related fields or as an advanced elective course for interested undergraduate students. The prerequisites for the course are a professional knowledge of at least one programming language (for implementing the node), a basic knowledge of networking (TCP/IP), basic understanding of probability theory (probabilities, expectations, distributions), discrete mathematics (graphs, proof techniques). A very basic understanding of cryptography (hashes, signatures, proof techniques) is helpful but not required.
        </p>

        <p>
            <strong>Prerequisites</strong>

            <ul>
                <li>CS106A, CS106B, or CS106X, or relevant programming experience</li>
                <li>CS103, or CS103B or related course on discrete math</li>
                <li>CS109, MATH151, STATS116, or EE178 or related course on probability</li>
            </ul>
        </p>

        <h2>Problem Sets</h2>

        <p>
            The problem sets are the most important part of this course.
            The problem sets are about implementation.
            They involve building our own blockchain, Marabu.
            It is a proof-of-work UTXO blockchain designed for educational purposes to be simple to implement and debug. As a student, you will implement your own Marabu full node from scratch. Your node must connect to the nodes of other students and maintain a common blockchain with them. You will implement the protocol by following through the problem sets. The protocol is a simplified, educational protocol easy to debug and implement designed especially for this course. Even though it is simple, it implements a full blockchain which follows the same principles as a full blockchain such as Bitcoin and Ethereum, albeit with limited features (it allows only for simple payments and is not very efficient). You can use whatever programming language you know well for your implementation.
            We recommend using TypeScript.
            We have seen successful implementations in Python, TypeScript and Go. The problem sets guide you through implementing your node in a step-by-step fashion, so each problem set builds on top of the previous one to augment your node slowly adding new features until it is complete.
            Students can collaborate to solve all problem sets in groups of up to 3 students. Only one submission is required per group.
        </p>

        <h2>Grading</h2>

        The grade for the course will be determined according to the following breakdown:

        <ul>
            <li><strong>Programming Exercises</strong>: 40%</li>
            <li><strong>Midterm</strong>: 20%</li>
            <li><strong>Final</strong>: 35%</li>
            <li><strong>Scribe</strong>: 5%</li>
        </ul>

        <h2>Bibliography</h2>

        <p>There are limited textbooks in the field. Therefore, we refer you to the lecture notes as the main reference point.</p>

        <p>We have used excerpts from the "<a href='http://www.cs.umd.edu/~jkatz/imc.html'>Introduction to Modern Cryptography</a>" book. In particular:</p>

        <ul>
            <li>The introduction, in particular the importance of definitions, assumptions, and proofs.</li>
            <li>The section on hash functions.</li>
            <li>The definition of signatures and the existential unforgeability game.</li>
            <li>The section on the Random Oracle model.</li>
        </ul>

        <p>We have also read a small part of Harari's <a href='https://en.wikipedia.org/wiki/Sapiens:_A_Brief_History_of_Humankind'>Sapiens</a> book and the fictional nature of money (Chapter 16).</p>

        <p>
        In addition, the following papers have been given in the readings:
        </p>
        <ul>
            <li><a href='https://bitcoin.org/bitcoin.pdf'>Nakamoto's Bitcoin pape</a></li>
            <li><a href='https://eprint.iacr.org/2014/765.pdf'>The Bitcoin Backbone</a> (up to and including the Analysis section)</li>
            <li><a href='https://www.cs.cornell.edu/~ie53/publications/btcProcFC.pdf'>The Selfish Mining</a></li>
            <li><a href='https://eprint.iacr.org/2020/088.pdf'>Streamlet</a> (excluding the liveness proof)</li>
            <li><a href='https://arxiv.org/pdf/2005.10484.pdf'>Everything is a Race and Nakanomoto Always Wins</a></li>
        </ul>

        <p>Some optional related readings we discussed in class:</p>
        <ul>
            <li><a href='https://jbonneau.com/doc/VBCKM16-FC-bitcoin_brain_wallets.pdf'>The Bitcoin Brain Drain</a></li>
            <li><a href='https://dl.acm.org/doi/pdf/10.1145/2976749.2978408'>On the Instability of Bitcoin Without the Block Reward</a></li>
            <li><a href='https://www.usenix.org/system/files/conference/usenixsecurity17/sec17-luu.pdf'>SmartPool: Practical Decentralized Pooled Mining</a></li>
        </ul>

        <h2>Comparison to Other Courses</h2>

        <p>This course is a good follow-up course on CS 251. CS 251 studies blockchains very broadly and covers a lot of material. It talks about consensus, smart contracts, Solidity, decentralized finance, zero-knowledge, BFT, and more. It also talks about Bitcoin-specific and Ethereum-specific details. In this course, we focus on the foundations of blockchains and speak only about the very basics concepts, in particular transactions and consensus, but in more detail and depth. We don't speak about engineering for Bitcoin and Ethereum specifically. On the engineering side of things, we implement consensus and transactions, and so these are explored in depth. On the theory side of things, we devote a couple weeks on proving the security of blockchains mathematically.</p>

        <p>
            CS251 is not a prerequisite, but if a student has taken CS 251, they will find this course easier to follow.
        </p>

        <p>
            If you have taken EE 374 any previous year, <strong>this is a completely new course</strong>,
            with a different syllabus and different psets.
        </p>
    </div></div></div></body>
</html>
